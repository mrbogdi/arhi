<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORE-ARCH Quantum v12.0 | 2026 Architectural Intelligence</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        
        :root {
            --accent: #2563eb;
            --accent-glow: rgba(37, 99, 235, 0.2);
            --surface: #ffffff;
            --bg: #f8fafc;
        }

        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg); color: #0f172a; scroll-behavior: smooth; }
        h1, h2, h3, .font-heading { font-family: 'Space Grotesk', sans-serif; }

        .sidebar-item { border-radius: 16px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); margin: 4px 12px; border: 1px solid transparent; }
        .sidebar-item.active { background: white; border-color: #e2e8f0; color: var(--accent); box-shadow: 0 10px 25px -5px rgba(0,0,0,0.05); }
        .sidebar-item:hover:not(.active) { background: #f1f5f9; transform: translateX(4px); }

        .main-card { background: white; border-radius: 32px; box-shadow: 0 20px 50px rgba(0,0,0,0.02); border: 1px solid #f1f5f9; transition: all 0.4s ease; }
        
        .input-group label { display: block; margin-bottom: 8px; font-size: 10px; font-weight: 800; color: #64748b; text-transform: uppercase; letter-spacing: 1px; }
        .input-group input, .input-group select { 
            width: 100%; padding: 14px 18px; border-radius: 16px; border: 2px solid #f1f5f9; 
            background: #f8fafc; font-weight: 600; font-size: 14px; outline: none; transition: all 0.2s;
        }
        .input-group input:focus, .input-group select:focus { border-color: var(--accent); background: white; box-shadow: 0 0 0 4px var(--accent-glow); }

        .viewport-3d { border-radius: 24px; background: radial-gradient(circle at 50% 50%, #ffffff 0%, #f1f5f9 100%); position: relative; }
        
        .status-badge { padding: 6px 14px; border-radius: 100px; font-size: 11px; font-weight: 800; text-transform: uppercase; display: inline-flex; align-items: center; gap: 6px; }
        .status-ok { background: #dcfce7; color: #15803d; border: 1px solid #bbf7d0; }
        .status-warn { background: #fef9c3; color: #a16207; border: 1px solid #fef08a; }
        .status-crit { background: #fee2e2; color: #b91c1c; border: 1px solid #fecaca; }

        .premium-gradient { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); }
        
        @media print { .no-print { display: none; } body { background: white; } .main-card { box-shadow: none; border: 1px solid #eee; } }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <header class="h-20 bg-white/80 backdrop-blur-xl sticky top-0 z-50 border-b flex items-center justify-between px-10 no-print">
        <div class="flex items-center gap-4">
            <div class="premium-gradient p-2.5 rounded-2xl shadow-xl shadow-blue-100">
                <i data-lucide="layers" class="text-white w-6 h-6"></i>
            </div>
            <div>
                <h1 class="text-xl font-bold tracking-tight">CORE-ARCH <span class="text-blue-600 italic">Quantum</span></h1>
                <div class="flex items-center gap-2">
                    <span class="flex h-2 w-2 rounded-full bg-green-500 animate-pulse"></span>
                    <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest">v12.0 Build 2026 • Real-time Compliance</p>
                </div>
            </div>
        </div>
        
        <div class="flex items-center gap-4">
            <div id="global-sync" class="text-[10px] font-bold text-slate-400 bg-slate-100 px-3 py-1 rounded-lg">SYNC: EUROCODE 2026.4</div>
            <button onclick="window.print()" class="bg-slate-900 text-white px-6 py-2.5 rounded-xl font-bold text-sm hover:bg-blue-600 transition-all flex items-center gap-2 shadow-lg shadow-slate-200">
                <i data-lucide="file-text" class="w-4 h-4"></i> Generare Deviz/PDF
            </button>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <aside class="w-85 bg-slate-50/50 border-r overflow-y-auto no-print pb-10">
            <div class="p-6">
                <div id="nav-list" class="space-y-1">
                    </div>
            </div>
        </aside>

        <main class="flex-1 overflow-y-auto p-10 bg-[#f8fafc]">
            <div class="max-w-7xl mx-auto grid grid-cols-12 gap-10">
                
                <div class="col-span-12 lg:col-span-7 space-y-8">
                    <section id="header-section">
                        <div class="flex items-center gap-3 mb-2">
                            <span id="mod-cat" class="text-blue-600 font-bold text-xs uppercase tracking-[0.2em]">Categorie</span>
                            <span class="h-[1px] w-12 bg-blue-200"></span>
                        </div>
                        <h2 id="mod-title" class="text-4xl font-extrabold text-slate-900 tracking-tight">Titlu Modul</h2>
                        <p id="mod-desc" class="text-slate-500 mt-4 leading-relaxed font-medium text-lg max-w-2xl"></p>
                    </section>

                    <div class="main-card p-10">
                        <div id="input-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            </div>
                    </div>

                    <div class="bg-white border border-slate-100 p-6 rounded-3xl flex gap-5 items-center shadow-sm">
                        <div class="bg-blue-50 p-3 rounded-2xl text-blue-600">
                            <i data-lucide="book-open" class="w-6 h-6"></i>
                        </div>
                        <div>
                            <h4 class="text-slate-900 font-bold text-sm">Referință Normativă:</h4>
                            <p id="mod-ref" class="text-slate-500 text-xs mt-1 font-medium"></p>
                        </div>
                    </div>
                </div>

                <div class="col-span-12 lg:col-span-5 space-y-6">
                    <div class="main-card overflow-hidden group">
                        <div class="p-4 border-b bg-slate-50/50 flex justify-between items-center">
                            <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Simulare Spațială 2026</span>
                            <div class="flex gap-2">
                                <span class="w-2 h-2 rounded-full bg-slate-200"></span>
                                <span class="w-2 h-2 rounded-full bg-slate-200"></span>
                            </div>
                        </div>
                        <div id="three-canvas" class="h-72 viewport-3d"></div>
                    </div>

                    <div id="res-border" class="main-card p-10 transition-all duration-500 border-l-[12px]">
                        <div class="flex justify-between items-start mb-8">
                            <div>
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-1">Rezultat Principal</span>
                                <div id="res-status" class="status-badge status-ok">Status</div>
                            </div>
                            <i id="res-icon" data-lucide="check-circle" class="w-8 h-8 opacity-20"></i>
                        </div>

                        <div class="flex items-baseline gap-3">
                            <span id="res-val" class="text-7xl font-black text-slate-900 tracking-tighter tabular-nums">0.00</span>
                            <span id="res-unit" class="text-xl font-extrabold text-blue-600 uppercase">Unit</span>
                        </div>
                        
                        <div id="res-msg" class="mt-8 p-5 rounded-2xl text-sm font-bold transition-all"></div>

                        <div id="res-subs" class="mt-8 pt-8 border-t border-slate-100 space-y-4">
                            </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const MODULES = {
            'fee-pro': {
                title: "Onorariu Arhitect 2026", cat: "Business", icon: "wallet",
                desc: "Calcul complex bazat pe valoarea investiției, complexitate și faze de proiectare conform standardelor OAR 2026.",
                ref: "Metodologia de calcul a onorariilor OAR / HG actualizată 2026.",
                inputs: [
                    { id: 'area', label: 'Suprafață Desfășurată (mp)', val: 250, type: 'number' },
                    { id: 'cost_mp', label: 'Cost Construcție (€/mp)', val: 950, type: 'number' },
                    { id: 'complexity', label: 'Complexitate (I-V)', val: 3, type: 'select', options: [
                        {l: 'Cat I - Garaje/Anexe (0.7)', v: 0.7},
                        {l: 'Cat II - Case Individuale (1.0)', v: 1.0},
                        {l: 'Cat III - Colective/Birouri (1.3)', v: 1.3},
                        {l: 'Cat IV - Spitale/Hotele (1.6)', v: 1.6},
                        {l: 'Cat V - Monumente/Restaurări (2.2)', v: 2.2}
                    ]},
                    { id: 'phase', label: 'Procent Fază', val: 1.0, type: 'select', options: [
                        {l: 'Toate fazele (100%)', v: 1.0},
                        {l: 'Concept + DTAC (45%)', v: 0.45},
                        {l: 'Proiect Tehnic + DE (40%)', v: 0.40},
                        {l: 'Asistență + Recepție (15%)', v: 0.15}
                    ]}
                ],
                calc: (v) => {
                    const investitie = v.area * v.cost_mp;
                    // Formula logaritmica degresiva pentru onorariu mediu (aprox 4-8%)
                    const base_rate = (15 - Math.log10(investitie) * 2) / 100;
                    const final_fee = investitie * base_rate * v.complexity * v.phase;
                    return { 
                        val: final_fee.toLocaleString('ro-RO', {maximumFractionDigits: 0}), 
                        unit: "€ Onorariu", 
                        status: 'ok',
                        msg: `Aproximativ ${( (final_fee/investitie)*100 ).toFixed(2)}% din investiție (${investitie.toLocaleString()} €).`,
                        subs: [
                            {l: 'TVA (19%)', v: (final_fee * 0.19).toFixed(0), u: '€'},
                            {l: 'Echivalent / mp', v: (final_fee / v.area).toFixed(1), u: '€/mp'}
                        ], 
                        dims: [Math.sqrt(v.area), 5, Math.sqrt(v.area)] 
                    }
                }
            },

            'urban-pro': {
                title: "Urbanism: POT & CUT", cat: "Reglementare", icon: "map", 
                desc: "Verificare instantă a indicilor urbanistici cu alerte de depășire conform PUG/PUZ.",
                ref: "Legea 350/2001 & RLU 2026.",
                inputs: [
                    { id: 'st', label: 'S. Teren (mp)', val: 1000, type: 'number' },
                    { id: 'sc', label: 'S. Construită (mp)', val: 350, type: 'number' },
                    { id: 'sd', label: 'S. Desfășurată (mp)', val: 700, type: 'number' },
                    { id: 'pot_m', label: 'POT Maxim (%)', val: 35, type: 'number' }
                ],
                calc: (v) => {
                    const pot = (v.sc / v.st) * 100;
                    const cut = v.sd / v.st;
                    const ok = pot <= v.pot_m;
                    return { 
                        val: pot.toFixed(1), unit: "% POT", status: ok ? 'ok' : 'crit',
                        msg: ok ? "Parametrii se încadrează în regulamentul local." : "ATENȚIE: POT depășit față de limita admisă!",
                        subs: [
                            {l: 'CUT Rezultat', v: cut.toFixed(2), u: 'idx'},
                            {l: 'S. Verde Necesară (min 20%)', v: (v.st * 0.2).toFixed(0), u: 'mp'}
                        ], 
                        dims: [Math.sqrt(v.st), 0.5, Math.sqrt(v.st)] 
                    }
                }
            },

            'nzeb-energy': {
                title: "Eficiență nZEB+", cat: "Performanță", icon: "Zap",
                desc: "Calculul necesarului de energie primară pentru standardele obligatorii 2026.",
                ref: "Normativ Mc001-2026 / Standarde nZEB+.",
                inputs: [
                    { id: 'u_val', label: 'Coef. U Mediu (W/m²K)', val: 0.20, type: 'number' },
                    { id: 'area_env', label: 'Suprafață Anvelopă (mp)', val: 450, type: 'number' },
                    { id: 'temp_diff', label: 'ΔT (Interior-Ext) (K)', val: 35, type: 'number' }
                ],
                calc: (v) => {
                    const loss = v.u_val * v.area_env * v.temp_diff;
                    const is_nzeb = v.u_val <= 0.15;
                    return { 
                        val: (loss/1000).toFixed(2), unit: "kW Pierdere", status: is_nzeb ? 'ok' : 'warn',
                        msg: is_nzeb ? "Clădirea respectă standardul nZEB+ (U < 0.15)." : "Recomandare: Creșteți grosimea termoizolației pentru nZEB.",
                        subs: [
                            {l: 'Necesar anual est.', v: ((loss*24*180)/1000).toFixed(0), u: 'kWh/an'},
                            {l: 'Grosime termo (estim)', v: (0.035 / v.u_val * 100).toFixed(0), u: 'cm'}
                        ], 
                        dims: [5, 5, 5] 
                    }
                }
            },

            'structure-wind': {
                title: "Vânt & Seism (2026)", cat: "Inginerie", icon: "wind",
                desc: "Calculul forțelor orizontale conform noilor hărți de zonare seismică din 2026.",
                ref: "Eurocode 1 & 8 (SR EN 1991 / 1998).",
                inputs: [
                    { id: 'v_base', label: 'Viteză Vânt (m/s)', val: 28, type: 'number' },
                    { id: 'ag', label: 'Acc. Seism ag (g)', val: 0.3, type: 'number' },
                    { id: 'height', label: 'Înălțime Z (m)', val: 12, type: 'number' }
                ],
                calc: (v) => {
                    const pressure = 0.5 * 1.25 * Math.pow(v.v_base, 2) * 2.1 / 1000;
                    const status = v.ag > 0.25 ? 'warn' : 'ok';
                    return { 
                        val: pressure.toFixed(2), unit: "kN/mp", status: status,
                        msg: "Presiune caracteristică calculată pentru structura principală.",
                        subs: [
                            {l: 'Forță bază seism', v: (v.ag * 9.81).toFixed(2), u: 'm/s²'},
                            {l: 'Perioada oscilație', v: (0.075 * Math.pow(v.height, 0.75)).toFixed(2), u: 'sec'}
                        ], 
                        dims: [2, v.height, 2] 
                    }
                }
            },

            'stair-expert': {
                title: "Scări: Pasul lui Blondel", cat: "Arhitectură", icon: "trending-up",
                desc: "Verificarea ergonomică și de siguranță a fluxurilor verticale.",
                ref: "Normativ P118 / Ergonomie.",
                inputs: [
                    { id: 'h_tot', label: 'Înălțime Totală (cm)', val: 300, type: 'number' },
                    { id: 'h_r', label: 'Înălțime Treaptă (cm)', val: 17.5, type: 'number' },
                    { id: 'w_r', label: 'Lățime Treaptă (cm)', val: 28, type: 'number' }
                ],
                calc: (v) => {
                    const nr = Math.round(v.h_tot / v.h_r);
                    const h_real = v.h_tot / nr;
                    const blondel = 2 * h_real + v.w_r;
                    const ok = blondel >= 62 && blondel <= 64;
                    return { 
                        val: blondel.toFixed(1), unit: "Blondel idx", status: ok ? 'ok' : 'crit',
                        msg: ok ? "Scară ergonomică perfectă." : "Pas incorect! Ajustați treapta sau contratreapta.",
                        subs: [
                            {l: 'Număr Trepte', v: nr, u: 'buc'},
                            {l: 'Înălțime Reală h', v: h_real.toFixed(2), u: 'cm'}
                        ], 
                        dims: [4, 0.2, 1] 
                    }
                }
            },

            'sun-analysis': {
                title: "Însorire (Studiu Solar)", cat: "Arhitectură", icon: "sun",
                desc: "Verifică durata minimă de însorire (1.5h la solstițiu) conform normelor de igienă.",
                ref: "Ordinul Min. Sănătății 119/2014.",
                inputs: [
                    { id: 'h_bldg', label: 'Înălțime Clădire (m)', val: 10, type: 'number' },
                    { id: 'dist', label: 'Distanță față de vecin (m)', val: 12, type: 'number' },
                    { id: 'angle', label: 'Unghi Solar Dec (grade)', val: 21, type: 'number' }
                ],
                calc: (v) => {
                    const shadow = v.h_bldg / Math.tan(v.angle * Math.PI / 180);
                    const risk = shadow > v.dist;
                    return { 
                        val: shadow.toFixed(1), unit: "m Umbră", status: risk ? 'crit' : 'ok',
                        msg: risk ? "Vecinătatea este umbrită excesiv!" : "Distanță conformă pentru însorire.",
                        subs: [
                            {l: 'Raport H/D', v: (v.h_bldg / v.dist).toFixed(2), u: 'idx'},
                            {l: 'Unghi minim', v: '21', u: '°'}
                        ], 
                        dims: [shadow, 0.1, 5] 
                    }
                }
            }
        };

        // --- CORE SYSTEM ---
        let activeMod = 'fee-pro';
        let scene, camera, renderer, mesh, controls;

        function init() {
            buildNav();
            init3D();
            loadModule(activeMod);
            lucide.createIcons();
            window.addEventListener('resize', onResize);
            
            function animate() {
                requestAnimationFrame(animate);
                if(controls) controls.update();
                renderer.render(scene, camera);
            }
            animate();
        }

        function buildNav() {
            const nav = document.getElementById('nav-list');
            const cats = [...new Set(Object.values(MODULES).map(m => m.cat))];
            
            nav.innerHTML = cats.map(c => `
                <div class="pt-6 pb-2 px-4 text-[9px] font-black text-slate-400 uppercase tracking-[0.2em]">${c}</div>
                ${Object.keys(MODULES).filter(k => MODULES[k].cat === c).map(k => `
                    <div class="sidebar-item px-4 py-3.5 flex items-center gap-3 cursor-pointer text-sm font-bold text-slate-600 ${activeMod === k ? 'active' : ''}" 
                         onclick="loadModule('${k}')">
                        <i data-lucide="${MODULES[k].icon}" class="w-4 h-4"></i>
                        <span>${MODULES[k].title}</span>
                    </div>
                `).join('')}
            `).join('');
            lucide.createIcons();
        }

        function loadModule(id) {
            activeMod = id;
            const m = MODULES[id];
            
            buildNav();

            document.getElementById('mod-cat').innerText = m.cat;
            document.getElementById('mod-title').innerText = m.title;
            document.getElementById('mod-desc').innerText = m.desc;
            document.getElementById('mod-ref').innerText = m.ref;

            const grid = document.getElementById('input-grid');
            grid.innerHTML = m.inputs.map(i => {
                if(i.type === 'select') {
                    return `
                        <div class="input-group">
                            <label>${i.label}</label>
                            <select id="inp-${i.id}" onchange="run()">
                                ${i.options.map(opt => `<option value="${opt.v}">${opt.l}</option>`).join('')}
                            </select>
                        </div>
                    `;
                }
                return `
                    <div class="input-group">
                        <label>${i.label}</label>
                        <input type="number" id="inp-${i.id}" value="${i.val}" oninput="run()">
                    </div>
                `;
            }).join('');

            run();
        }

        function run() {
            const m = MODULES[activeMod];
            const vals = {};
            m.inputs.forEach(i => vals[i.id] = parseFloat(document.getElementById(`inp-${i.id}`).value) || 0);

            const res = m.calc(vals);

            // Update UI
            const resValEl = document.getElementById('res-val');
            resValEl.innerText = res.val;
            
            // Animatie cifra
            resValEl.classList.remove('animate-pulse');
            void resValEl.offsetWidth; 
            resValEl.classList.add('animate-pulse');

            document.getElementById('res-unit').innerText = res.unit;
            document.getElementById('res-status').innerText = res.status === 'ok' ? 'Parametru Optim' : (res.status === 'crit' ? 'Eroare/Neconform' : 'Atenție Proiectare');
            document.getElementById('res-status').className = `status-badge status-${res.status}`;
            
            const accentColor = res.status === 'ok' ? '#22c55e' : (res.status === 'crit' ? '#ef4444' : '#eab308');
            document.getElementById('res-border').style.borderLeftColor = accentColor;
            
            const msgBox = document.getElementById('res-msg');
            msgBox.innerText = res.msg;
            msgBox.className = `mt-8 p-5 rounded-2xl text-sm font-bold bg-slate-50 border border-slate-100 text-slate-700`;

            document.getElementById('res-subs').innerHTML = res.subs.map(s => `
                <div class="flex justify-between items-center group/item">
                    <span class="text-slate-400 text-[10px] font-black uppercase tracking-widest">${s.l}</span>
                    <span class="text-slate-900 font-black tabular-nums">${s.v} <span class="text-[10px] text-blue-600 font-bold">${s.u}</span></span>
                </div>
            `).join('');

            updateMesh(res.dims);
        }

        function init3D() {
            const container = document.getElementById('three-canvas');
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(10, 10, 10);
            
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;

            const amb = new THREE.AmbientLight(0xffffff, 0.8);
            scene.add(amb);
            
            const sun = new THREE.DirectionalLight(0xffffff, 0.6);
            sun.position.set(5, 10, 7);
            scene.add(sun);
            
            const grid = new THREE.GridHelper(30, 30, 0xe2e8f0, 0xf1f5f9);
            scene.add(grid);
        }

        function updateMesh(d) {
            if(mesh) scene.remove(mesh);
            
            // Normalizează dimensiunile pentru vizibilitate
            const scale = 5 / Math.max(...d);
            const geometry = new THREE.BoxGeometry(d[0]*scale, d[1]*scale, d[2]*scale);
            
            const material = new THREE.MeshPhongMaterial({ 
                color: 0x2563eb, 
                transparent: true, 
                opacity: 0.15,
                shininess: 100
            });
            
            mesh = new THREE.Mesh(geometry, material);
            
            const edges = new THREE.EdgesGeometry(geometry);
            const line = new THREE.LineSegments(edges, new THREE.LineBasicMaterial({ color: 0x2563eb, linewidth: 2 }));
            mesh.add(line);
            
            mesh.position.y = (d[1]*scale)/2;
            scene.add(mesh);
        }

        function onResize() {
            const container = document.getElementById('three-canvas');
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }

        init();
    </script>
</body>
</html>
