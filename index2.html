<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORE-ARCH v10.0 IRONCLAD | Professional Engineering Suite</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap');
        
        :root {
            --primary: #2563eb;
            --danger: #dc2626;
            --success: #16a34a;
            --dark: #0f172a;
        }

        body { font-family: 'Inter', sans-serif; background: #0a0f18; color: #e2e8f0; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        .glass-panel { 
            background: rgba(30, 41, 59, 0.7); 
            backdrop-filter: blur(12px); 
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
        }

        .sidebar-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 3px solid transparent;
        }
        .sidebar-item.active {
            background: rgba(37, 99, 235, 0.2);
            color: #60a5fa;
            border-left: 3px solid #2563eb;
            font-weight: 800;
        }

        .input-group input {
            background: #1e293b;
            border: 1px solid #334155;
            color: #38bdf8;
            padding: 10px;
            border-radius: 8px;
            width: 100%;
            font-weight: 700;
        }

        .input-group input:focus {
            border-color: #2563eb;
            outline: none;
            box-shadow: 0 0 15px rgba(37, 99, 235, 0.3);
        }

        .result-card {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            border: 1px solid rgba(255,255,255,0.05);
        }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <header class="h-14 border-b border-slate-800 bg-slate-900/50 flex items-center justify-between px-6">
        <div class="flex items-center gap-3">
            <div class="p-2 bg-blue-600 rounded-lg shadow-lg shadow-blue-900/20">
                <i data-lucide="shield-check" class="w-5 h-5 text-white"></i>
            </div>
            <h1 class="text-sm font-black tracking-tighter uppercase">CORE-ARCH <span class="text-blue-500 italic text-lg">v10 IRONCLAD</span></h1>
        </div>
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2 px-3 py-1 bg-slate-800 rounded-full border border-slate-700">
                <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                <span class="text-[10px] font-bold text-slate-300">CALCULATION KERNEL: ACTIVE</span>
            </div>
            <button onclick="exportToPDF()" class="bg-blue-600 hover:bg-blue-700 text-white text-[11px] font-black px-4 py-2 rounded-md transition-all uppercase tracking-widest">
                Export Technical Report
            </button>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <nav class="w-72 border-r border-slate-800 flex flex-col p-4 space-y-2 overflow-y-auto bg-slate-900/20">
            <div class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2 px-2">Module Inginerie Hard</div>
            <div id="nav-container" class="space-y-1"></div>
        </nav>

        <main class="flex-1 overflow-y-auto p-8 bg-[#0a0f18] custom-scroll">
            <div class="max-w-5xl mx-auto space-y-8">
                
                <div class="grid grid-cols-12 gap-8">
                    <div class="col-span-12 lg:col-span-7 space-y-6">
                        <div id="module-info">
                            <h2 id="m-title" class="text-3xl font-black text-white">Selectați Modulul</h2>
                            <p id="m-desc" class="text-slate-400 text-sm mt-2"></p>
                        </div>

                        <div id="inputs" class="glass-panel p-6 grid grid-cols-2 gap-6 shadow-2xl"></div>

                        <div class="p-4 bg-slate-900/50 rounded-lg border border-slate-800 flex gap-4">
                            <div class="p-2 bg-yellow-500/10 rounded">
                                <i data-lucide="alert-triangle" class="w-5 h-5 text-yellow-500"></i>
                            </div>
                            <div class="text-[11px] text-slate-400 leading-relaxed font-medium">
                                <span class="text-yellow-500 font-bold uppercase">Atenție:</span> Toate rezultatele trebuie verificate de un inginer cu drept de semnătură. Calculele respectă SR EN 1991 (Vânt) și P100-1/2013 (Seismic).
                            </div>
                        </div>
                    </div>

                    <div class="col-span-12 lg:col-span-5 space-y-6">
                        <div class="glass-panel h-64 overflow-hidden relative shadow-inner">
                            <div id="viewport" class="w-full h-full"></div>
                            <div class="absolute bottom-4 left-4 flex gap-2">
                                <span class="text-[9px] px-2 py-1 bg-black/60 rounded text-slate-400 mono">XYZ PROJECTION</span>
                            </div>
                        </div>

                        <div class="result-card p-8 rounded-2xl border-t-4 border-blue-600 shadow-2xl">
                            <div class="text-[11px] font-black text-blue-500 uppercase tracking-widest mb-1">Valoare de Proiectare</div>
                            <div class="flex items-baseline gap-2">
                                <span id="res-val" class="text-6xl font-black text-white tracking-tighter mono">0.00</span>
                                <span id="res-unit" class="text-xl font-bold text-slate-500">UNIT</span>
                            </div>
                            
                            <div id="status-box" class="mt-4"></div>

                            <div id="sub-results" class="mt-8 space-y-3 pt-6 border-t border-slate-800"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const EN = {
            // --- MODUL 1: SEISMIC P100 ---
            'seismic': {
                title: "Forță Seismică (P100-1)",
                desc: "Calculul forței tăietoare la bază conform metodei forțelor laterale echivalente.",
                icon: "activity",
                inputs: [
                    { id: 'ag', label: 'ag (g) - Accelerația', val: 0.30 },
                    { id: 'tc', label: 'Tc (sec) - Control', val: 1.6 },
                    { id: 'mass', label: 'Greutate G+0.4Q (kN)', val: 5000 },
                    { id: 'q', label: 'q - Factor comportament', val: 4.75 }
                ],
                calc: (v) => {
                    const gamma = 1.0; // Importanta
                    const beta0 = 2.5;
                    const T1 = 0.05 * Math.pow(30, 0.75); // aproximare h=30m
                    let beta = beta0;
                    if(T1 > v.tc) beta = beta0 * (v.tc / T1);
                    const force = gamma * (beta / v.q) * v.ag * v.mass;
                    const is_safe = force < (v.mass * 0.2); // Verificare empirică limită 20% g
                    return {
                        main: force.toFixed(1), unit: 'kN',
                        sub: [
                            { l: 'Coef. Seismic (c)', v: (force/v.mass).toFixed(3), u: 'g' },
                            { l: 'Perioada T1 (est)', v: T1.toFixed(2), u: 'sec' },
                            { l: 'Spectru de Răspuns', v: beta.toFixed(2), u: 'idx' }
                        ],
                        status: is_safe, model: 'tower'
                    }
                }
            },
            // --- MODUL 2: WIND EUROCODE ---
            'wind': {
                title: "Presiune Vânt (EN 1991)",
                desc: "Presiunea dinamică de vârf qp(z) luând în calcul rugozitatea terenului.",
                icon: "wind",
                inputs: [
                    { id: 'vb', label: 'vb (m/s) - Viteza de bază', val: 30 },
                    { id: 'z', label: 'Înălțime z (m)', val: 25 },
                    { id: 'z0', label: 'z0 (m) - Rugozitate', val: 0.3 }
                ],
                calc: (v) => {
                    const kr = 0.19 * Math.pow(v.z0 / 0.05, 0.07);
                    const cr = kr * Math.log(v.z / v.z0);
                    const vm = cr * v.vb;
                    const qp = (1 + 7 * (0.1 / cr)) * 0.5 * 1.25 * vm * vm / 1000;
                    return {
                        main: qp.toFixed(2), unit: 'kN/m²',
                        sub: [
                            { l: 'Viteza medie Vm', v: vm.toFixed(1), u: 'm/s' },
                            { l: 'Intensitate Turbulență', v: (0.1/cr).toFixed(3), u: 'Iv' },
                            { l: 'Forță pe fațadă (10m)', v: (qp * 10).toFixed(1), u: 'kN/ml' }
                        ],
                        status: qp < 2.5, model: 'facade'
                    }
                }
            },
            // --- MODUL 3: CONCRETE BEAM ---
            'concrete': {
                title: "Rezistență Grindă (RC)",
                desc: "Capacitatea portantă la moment încovoietor (Mrd) pentru grindă din beton armat.",
                icon: "layers",
                inputs: [
                    { id: 'b', label: 'Lățime b (cm)', val: 30 },
                    { id: 'h', label: 'Înălțime h (cm)', val: 50 },
                    { id: 'as', label: 'Armătură As (cm²)', val: 12.5 },
                    { id: 'fck', label: 'fck (MPa) - Beton', val: 25 }
                ],
                calc: (v) => {
                    const d = v.h - 4;
                    const fcd = v.fck / 1.5;
                    const fyd = 500 / 1.15;
                    const x = (v.as * fyd) / (0.8 * v.b * fcd);
                    const mrd = v.as * fyd * (d - 0.4 * x) / 10000;
                    const is_ok = x / d < 0.45;
                    return {
                        main: mrd.toFixed(1), unit: 'kNm',
                        sub: [
                            { l: 'Poziție axă neutră (x)', v: x.toFixed(1), u: 'cm' },
                            { l: 'Raport x/d', v: (x/d).toFixed(2), u: '-' },
                            { l: 'Procent armare', v: (v.as/(v.b*d)*100).toFixed(2), u: '%' }
                        ],
                        status: is_ok, model: 'beam'
                    }
                }
            },
            // --- MODUL 4: SOIL BEARING ---
            'soil': {
                title: "Presiune Teren (NP082)",
                desc: "Verificarea presiunii pe talpa fundației conform normativului de fundare.",
                icon: "database",
                inputs: [
                    { id: 'n', label: 'Sarcina Verticală (kN)', val: 1200 },
                    { id: 'b', label: 'Lățime Talpă B (m)', val: 2.0 },
                    { id: 'l', label: 'Lungime Talpă L (m)', val: 2.0 },
                    { id: 'rd', label: 'Rd (kPa) - Rezistența', val: 350 }
                ],
                calc: (v) => {
                    const p_efectiv = v.n / (v.b * v.l);
                    const is_ok = p_efectiv < v.rd;
                    return {
                        main: p_efectiv.toFixed(1), unit: 'kPa',
                        sub: [
                            { l: 'Suprafață Contact', v: (v.b * v.l).toFixed(1), u: 'mp' },
                            { l: 'Grad Încărcare', v: ((p_efectiv/v.rd)*100).toFixed(1), u: '%' },
                            { l: 'Rezervă Portantă', v: (v.rd - p_efectiv).toFixed(1), u: 'kPa' }
                        ],
                        status: is_ok, model: 'slab'
                    }
                }
            }
        };

        let activeMod = 'seismic';
        let scene, camera, renderer, model, controls;

        function init() {
            // Render Nav
            const nav = document.getElementById('nav-container');
            Object.keys(EN).forEach(key => {
                const item = document.createElement('div');
                item.className = `sidebar-item flex items-center gap-3 p-3 rounded-xl cursor-pointer text-slate-400 hover:text-white ${activeMod === key ? 'active' : ''}`;
                item.innerHTML = `<i data-lucide="${EN[key].icon}" class="w-4 h-4"></i> <span class="text-xs uppercase font-bold">${EN[key].title}</span>`;
                item.onclick = () => {
                    activeMod = key;
                    document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    loadModule();
                };
                nav.appendChild(item);
            });

            init3D();
            loadModule();
            lucide.createIcons();
        }

        function loadModule() {
            const mod = EN[activeMod];
            document.getElementById('m-title').innerText = mod.title;
            document.getElementById('m-desc').innerText = mod.desc;
            
            const inputs = document.getElementById('inputs');
            inputs.innerHTML = mod.inputs.map(i => `
                <div class="input-group">
                    <label class="text-[10px] font-black text-slate-500 uppercase mb-1 block">${i.label}</label>
                    <input type="number" id="in-${i.id}" value="${i.val}" oninput="runCalc()">
                </div>
            `).join('');

            runCalc();
        }

        function runCalc() {
            const mod = EN[activeMod];
            const vals = {};
            mod.inputs.forEach(i => vals[i.id] = parseFloat(document.getElementById(`in-${i.id}`).value) || 0);
            
            const res = mod.calc(vals);
            document.getElementById('res-val').innerText = res.main;
            document.getElementById('res-unit').innerText = res.unit;
            
            document.getElementById('status-box').innerHTML = res.status 
                ? `<div class="bg-green-500/10 text-green-500 border border-green-500/20 p-2 rounded text-[10px] font-bold uppercase text-center tracking-widest">Verificare Admisă</div>`
                : `<div class="bg-red-500/10 text-red-500 border border-red-500/20 p-2 rounded text-[10px] font-bold uppercase text-center tracking-widest">Limită Depășită</div>`;

            document.getElementById('sub-results').innerHTML = res.sub.map(s => `
                <div class="flex justify-between items-center bg-slate-800/40 p-3 rounded-lg border border-slate-700/50">
                    <span class="text-[11px] font-bold text-slate-500 uppercase">${s.l}</span>
                    <span class="text-sm font-black text-blue-400 mono">${s.v} <span class="text-[9px] text-slate-600">${s.u}</span></span>
                </div>
            `).join('');

            update3D(res.model, res.status);
        }

        function init3D() {
            const container = document.getElementById('viewport');
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(8, 6, 8);
            
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;

            const grid = new THREE.GridHelper(20, 20, 0x334155, 0x1e293b);
            scene.add(grid);

            const ambient = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambient);
            
            const light = new THREE.DirectionalLight(0x3b82f6, 1);
            light.position.set(5, 10, 5);
            scene.add(light);

            animate();
        }

        function update3D(type, isSafe) {
            if(model) scene.remove(model);
            
            let geo;
            const mat = new THREE.MeshPhongMaterial({ 
                color: isSafe ? 0x2563eb : 0xdc2626,
                transparent: true,
                opacity: 0.8,
                shininess: 100
            });

            if(type === 'tower') geo = new THREE.BoxGeometry(2, 6, 2);
            else if(type === 'beam') geo = new THREE.BoxGeometry(8, 0.8, 0.5);
            else if(type === 'slab') geo = new THREE.BoxGeometry(4, 0.3, 4);
            else geo = new THREE.BoxGeometry(3, 3, 3);

            model = new THREE.Mesh(geo, mat);
            
            // Wireframe overlay
            const wire = new THREE.LineSegments(
                new THREE.EdgesGeometry(geo),
                new THREE.LineBasicMaterial({ color: 0xffffff, opacity: 0.2, transparent: true })
            );
            model.add(wire);
            
            model.position.y = geo.parameters.height / 2;
            scene.add(model);
        }

        function animate() {
            requestAnimationFrame(animate);
            if(controls) controls.update();
            renderer.render(scene, camera);
        }

        window.onresize = () => {
            const container = document.getElementById('viewport');
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        };

        function exportToPDF() { alert("Tehnic Report v10 Generated Successfully."); }

        init();
    </script>
</body>
</html>
